# Contributor:
# Maintainer: Tristan IsraÃ«l <tristan.israel@alefbet.net>
pkgname=safecor-splash
pkgver=1.0
pkgrel=0
pkgdesc="Safecor - Splash screen"
url="https://www.alefbet.net/"
arch="noarch"
license="MIT"
depends="fbida-fbi"
makedepends="imagemagick"
builddir="$srcdir/$pkgname-$pkgver"
install="$pkgname.pre-install $pkgname.post-install $pkgname.pre-deinstall $pkgname.post-deinstall"
checkdepends=""
subpackages=""
replaces=""
options="!check"  # no tests provided

source="
splash_ng_nobg.png
show-splash.sh
hide-splash.sh
"

splash_file="splash_ng_nobg.png"

build() {
    mkdir -p "$builddir"
    echo "Convert splash to PPM"
    magick convert "$srcdir/$splash_file" "$builddir/fbsplash0.ppm"
}

package() {
    install -D -m644 "$srcdir/$splash_file" "$pkgdir"/boot/splash.png
    install -D -m644 "$builddir"/fbsplash0.ppm "$pkgdir"/boot/fbsplash0.ppm
    install -D -m755 "$srcdir"/show-splash.sh "$pkgdir"/usr/lib/safecor/bin/show-splash.sh
    install -D -m755 "$srcdir"/hide-splash.sh "$pkgdir"/usr/lib/safecor/bin/hide-splash.sh   
}
